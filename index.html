<!doctype html>
<html lang="en">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>LifeTracker Pro</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .header {
            text-align: center;
            color: white;
            margin-bottom: 30px;
        }
        
        .header h1 {
            font-size: 3rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }
        
        .date-display {
            font-size: 1.2rem;
            opacity: 0.9;
        }
        
        .main-content {
            display: grid;
            grid-template-columns: 1fr 300px;
            gap: 30px;
        }
        
        .tracking-section {
            background: white;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            min-height: calc(100vh - 200px);
        }
        
        .sidebar {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }
        
        .quote-card {
            background: rgba(255,255,255,0.95);
            border-radius: 15px;
            padding: 25px;
            text-align: center;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        
        .quote-text {
            font-style: italic;
            font-size: 1.1rem;
            margin-bottom: 10px;
            color: #555;
        }
        
        .quote-author {
            font-weight: bold;
            color: #667eea;
        }
        
        .consistency-card {
            background: rgba(255,255,255,0.95);
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        
        .consistency-title {
            font-size: 1.3rem;
            margin-bottom: 15px;
            color: #333;
            text-align: center;
        }
        
        .consistency-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 0;
            border-bottom: 1px solid #eee;
        }
        
        .consistency-item:last-child {
            border-bottom: none;
        }
        
        .consistency-status {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 0.8rem;
        }
        
        .status-good {
            background: #4CAF50;
        }
        
        .status-bad {
            background: #f44336;
        }
        
        .input-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .input-group {
            background: #f8f9fa;
            border-radius: 12px;
            padding: 20px;
            border: 2px solid transparent;
            transition: all 0.3s ease;
        }
        
        .input-group:hover {
            border-color: #667eea;
            transform: translateY(-2px);
        }
        
        .input-group label {
            display: block;
            font-weight: 600;
            margin-bottom: 8px;
            color: #555;
        }
        
        .input-group input {
            width: 100%;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 1rem;
            transition: border-color 0.3s ease;
        }
        
        .input-group input:focus {
            outline: none;
            border-color: #667eea;
        }
        
        .sleep-expanded, .training-expanded {
            grid-column: span 2;
        }
        
        .sleep-details, .training-checkboxes, .run-details {
            margin-top: 15px;
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
        }
       
        .sleep-card {
            background: rgba(255,255,255,0.95);
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .sleep-score {
            text-align: center;
            font-size: 2.5rem;
            font-weight: bold;
            margin: 10px 0;
            color: #667eea;
        }

         /* Style for hour/minute input pairs */
        .hour-minute-group {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 5px;
        }
        
        .hour-minute-group input {
            text-align: center;
            padding: 8px;
        }
        
        /* Style for sleep time inputs */
        .sleep-time-inputs {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin-bottom: 10px;
        }
        
        .sleep-time-inputs > div {
            display: flex;
            flex-direction: column;
        }
        
        .sleep-time-inputs label {
            font-size: 0.9rem;
            color: #666;
            margin-bottom: 5px;
        }
        .sleep-breakdown {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin-top: 15px;
        }
        
        .sleep-metric {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 10px;
            text-align: center;
        }
        
        .sleep-metric-label {
            font-size: 0.8rem;
            color: #666;
            margin-bottom: 5px;
        }
        
        .sleep-metric-value {
            font-size: 1.2rem;
            font-weight: bold;
            color: #333;
        }
        
        .sleep-stage-bar {
            height: 8px;
            border-radius: 4px;
            margin-top: 5px;
            overflow: hidden;
            background: #e0e0e0;
        }
        
        .sleep-stage-fill {
            height: 100%;
            border-radius: 4px;
        }
        
        .sleep-detail-item, .run-detail-item {
            display: flex;
            flex-direction: column;
        }
        
        .sleep-detail-item label, .run-detail-item label {
            font-size: 0.9rem;
            margin-bottom: 5px;
            color: #666;
        }
        
        .sleep-detail-item input, .run-detail-item input, .run-detail-item select {
            padding: 8px;
            border: 2px solid #ddd;
            border-radius: 6px;
            font-size: 0.95rem;
        }
        
        .run-detail-item select {
            cursor: pointer;
            background: white;
        }
        
        .training-checkboxes {
            grid-template-columns: 1fr;
            gap: 10px;
        }
        
        .run-details {
            margin-top: 15px;
            padding-top: 15px;
            border-top: 2px solid #e0e0e0;
        }
        /* Pause/Freeze Button Styles */
        .pause-section {
            background: rgba(255,255,255,0.95);
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            margin-top: 10px;
        }
        
        .pause-title {
            font-size: 1.3rem;
            margin-bottom: 15px;
            color: #333;
            text-align: center;
        }
        
        .pause-toggle {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 15px;
            padding: 10px;
            background: #f8f9fa;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .pause-toggle:hover {
            background: #e9ecef;
        }
        
        .pause-toggle.active {
            background: #fff3cd;
            border: 2px solid #ffc107;
        }
        
        .pause-checkbox {
            width: 24px;
            height: 24px;
            cursor: pointer;
        }
        
        .pause-label {
            flex-grow: 1;
            margin-left: 10px;
            font-weight: 600;
            color: #333;
        }
        
        .pause-days {
            font-size: 0.9rem;
            color: #666;
            background: white;
            padding: 5px 10px;
            border-radius: 15px;
            font-weight: bold;
        }
        
        .pause-note {
            font-size: 0.8rem;
            color: #666;
            text-align: center;
            margin-top: 10px;
            padding-top: 10px;
            border-top: 1px solid #eee;
        }

        /* Reset Button Styles */
        .reset-section {
            background: rgba(255,255,255,0.95);
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            margin-top: 10px;
        }
        
        .reset-title {
            font-size: 1.3rem;
            margin-bottom: 15px;
            color: #333;
            text-align: center;
        }
        
        .reset-btn {
            width: 100%;
            padding: 12px;
            background: linear-gradient(135deg, #f44336, #d32f2f);
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-bottom: 10px;
        }
        
        .reset-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(244, 67, 54, 0.4);
        }
        
        .reset-confirm {
            display: none;
            margin-top: 10px;
            padding: 15px;
            background: #fff3cd;
            border-radius: 10px;
            border: 1px solid #ffc107;
        }
        
        .reset-confirm-buttons {
            display: flex;
            gap: 10px;
            margin-top: 10px;
        }
        
        .reset-confirm-btn {
            flex: 1;
            padding: 8px;
            border: none;
            border-radius: 6px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        .reset-confirm-yes {
            background: #f44336;
            color: white;
        }
        
        .reset-confirm-yes:hover {
            background: #d32f2f;
        }
        
        .reset-confirm-no {
            background: #6c757d;
            color: white;
        }
        
        .reset-confirm-no:hover {
            background: #545b62;
        }
        
        .reset-note {
            font-size: 0.8rem;
            color: #666;
            text-align: center;
            margin-top: 5px;
        }

        /* Points System Styles */
        .points-card {
            background: rgba(255,255,255,0.95);
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        
        .points-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .points-title {
            font-size: 1.3rem;
            color: #333;
        }
        
        .points-total {
            font-size: 2rem;
            font-weight: bold;
            background: linear-gradient(135deg, #FFD700, #FFA500);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-shadow: 0 2px 4px rgba(255, 215, 0, 0.3);
        }
        
        .points-breakdown {
            max-height: 200px;
            overflow-y: auto;
            margin-top: 10px;
        }
        
        .points-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 0;
            border-bottom: 1px solid #eee;
        }
        
        .points-item:last-child {
            border-bottom: none;
        }
        
        .points-activity {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .points-emoji {
            font-size: 1.2rem;
        }
        
        .points-value {
            font-weight: bold;
            color: #FF9800;
        }
        
        .points-multiplier {
            font-size: 0.8rem;
            color: #4CAF50;
            margin-left: 5px;
        }
        
        .points-today {
            text-align: center;
            margin-top: 15px;
            padding-top: 15px;
            border-top: 2px solid #FFD700;
            font-weight: bold;
            color: #333;
        }
        
        .level-indicator {
            margin-top: 10px;
            text-align: center;
        }
        
        .level-bar {
            height: 8px;
            background: #e0e0e0;
            border-radius: 4px;
            overflow: hidden;
            margin: 5px 0;
        }
        
        .level-progress {
            height: 100%;
            background: linear-gradient(90deg, #4CAF50, #8BC34A);
            border-radius: 4px;
            transition: width 0.5s ease;
        }
        
        .level-text {
            font-size: 0.9rem;
            color: #666;
        }
        
        @media (max-width: 768px) {
            .sleep-expanded, .training-expanded {
                grid-column: span 1;
            }
            
            .sleep-details {
                grid-template-columns: 1fr;
            }
        }
        
        .checkbox-group {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-top: 10px;
        }
        
        .checkbox-group input[type="checkbox"] {
            width: 20px;
            height: 20px;
            cursor: pointer;
        }
        
        .checkbox-group label {
            margin: 0;
            cursor: pointer;
        }
        
        .cold-shower-checked {
            background: linear-gradient(135deg, #4CAF50, #45a049) !important;
            color: white;
        }
        
        .lust-checked {
            background: linear-gradient(135deg, #f44336, #d32f2f) !important;
            color: white;
        }
        
        .nav-buttons {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 20px;
            justify-content: center;
        }
        
        .nav-btn {
            padding: 10px 20px;
            border: none;
            border-radius: 25px;
            background: #667eea;
            color: white;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
        }
        
        .nav-btn:hover {
            background: #5a6fd8;
            transform: translateY(-2px);
        }
        
        .nav-btn.active {
            background: #764ba2;
        }
        
        .chart-container {
            background: white;
            border-radius: 12px;
            padding: 20px;
            margin-top: 20px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            height: 480px; 
            position: relative;
        }
        
        .chart-title {
            text-align: center;
            margin-bottom: 30px;
            font-size: 1.5rem;
            color: #333;
        }

        .chart-wrapper {
            position: absolute;
            top: 70px; /* Space for title and period selector */
            bottom: 20px;
            left: 20px;
            right: 20px;
        }
        
        .period-selector {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-bottom: 20px;
        }
        
        .period-btn {
            padding: 8px 16px;
            border: 2px solid #667eea;
            border-radius: 20px;
            background: white;
            color: #667eea;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
        }
        
        .period-btn.active {
            background: #667eea;
            color: white;
        }
        
        .save-btn {
            display: block;
            width: 200px;
            margin: 30px auto;
            padding: 15px;
            background: linear-gradient(135deg, #4CAF50, #45a049);
            color: white;
            border: none;
            border-radius: 25px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .save-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(76, 175, 80, 0.4);
        }
        
        @media (max-width: 768px) {
            .main-content {
                grid-template-columns: 1fr;
            }
            
            .input-grid {
                grid-template-columns: 1fr;
            }
            
            .header h1 {
                font-size: 2rem;
            }
        }
    </style>
  <style>@view-transition { navigation: auto; }</style>
  <script src="/_sdk/data_sdk.js" type="text/javascript"></script>
  <script src="/_sdk/element_sdk.js" type="text/javascript"></script>
  <script src="https://cdn.tailwindcss.com" type="text/javascript"></script>
 </head>
 <body>
  <div class="container">
   <div class="header">
    <h1>üåü LifeTracker Pro</h1>
    <div class="date-display" id="currentDate"></div>
   </div>
   <div class="main-content">
    <div class="tracking-section">
     <div class="input-grid">
      
      <div class="input-group"><label for="stretching">üßò Stretching Sessions</label> <input type="number" id="stretching" placeholder="Enter sessions">
      </div>
      <div class="input-group"><label for="steps">üëü Steps Taken</label> <input type="number" id="steps" placeholder="Enter steps">
      </div>
      <div class="input-group sleep-expanded">
        <label for="sleepHours">üò¥ Sleep Time</label>
        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-bottom: 10px;">
          <div>
            <label for="sleepHours" style="font-size: 0.9rem; color: #666;">Hours</label>
            <input type="number" id="sleepHours" step="0.5" placeholder="Hours" min="0" max="24">
          </div>
          <div>
            <label for="sleepMinutes" style="font-size: 0.9rem; color: #666;">Minutes</label>
            <input type="number" id="sleepMinutes" placeholder="Minutes" min="0" max="59">
          </div>
        </div>
        <div class="sleep-details">
          <div class="sleep-detail-item">
            <label for="sleepQuality">Quality (1-100)</label>
            <input type="number" id="sleepQuality" min="1" max="100" placeholder="Rate 1-100">
          </div>
          
          <div class="sleep-detail-item">
            <label>REM Sleep</label>
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 5px;">
              <input type="number" id="remHours" placeholder="H" min="0" max="24" style="text-align: center;">
              <input type="number" id="remMinutes" placeholder="M" min="0" max="59" style="text-align: center;">
            </div>
          </div>
          
          <div class="sleep-detail-item">
            <label>Deep Sleep</label>
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 5px;">
              <input type="number" id="deepHours" placeholder="H" min="0" max="24" style="text-align: center;">
              <input type="number" id="deepMinutes" placeholder="M" min="0" max="59" style="text-align: center;">
            </div>
          </div>
          
          <div class="sleep-detail-item">
            <label>Light Sleep</label>
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 5px;">
              <input type="number" id="lightHours" placeholder="H" min="0" max="24" style="text-align: center;">
              <input type="number" id="lightMinutes" placeholder="M" min="0" max="59" style="text-align: center;">
            </div>
          </div>
          
          <div class="checkbox-group" style="margin-top: 10px;">
            <input type="checkbox" id="napped">
            <label for="napped">Took a nap today</label>
          </div>
        </div>
      </div>
      <div class="input-group"><label for="water">üíß Water (Liters)</label> <input type="number" id="water" step="0.1" placeholder="Enter liters">
      </div>
      <div class="input-group"><label for="screenTime">üì± Screen Time (Hours)</label> <input type="number" id="screenTime" step="0.5" placeholder="Enter hours">
      </div>
      <div class="input-group"><label for="pages">üìö Pages Read</label> <input type="number" id="pages" placeholder="Enter pages">
      </div>
      <div class="input-group training-expanded"><label>üí™ Training Sessions</label>
       <div class="training-checkboxes">
        <div class="checkbox-group"><input type="checkbox" id="hadGym"> <label for="hadGym">Gym Session</label>
        </div>
        <div class="checkbox-group"><input type="checkbox" id="hadRun"> <label for="hadRun">Running Session</label>
        </div>
       </div>
       <div id="runDetails" class="run-details" style="display: none;">
        <div class="run-detail-item"><label for="runType">Run Type</label> <select id="runType"> <option value="">Select type</option> <option value="interval">Interval Training</option> <option value="free">Free Run</option> <option value="race">Race</option> <option value="tempo">Tempo Run</option> <option value="long">Long Distance</option> <option value="recovery">Recovery Run</option> </select>
        </div>
        <div class="run-detail-item"><label for="runDistance">Distance (km)</label> <input type="number" id="runDistance" step="0.1" placeholder="Enter distance">
        </div>
       </div>
      </div>
      <div class="input-group" id="coldShowerGroup"><label>üöø Cold Shower</label>
       <div class="checkbox-group"><input type="checkbox" id="coldShower"> <label for="coldShower">Took cold shower today</label>
       </div>
      </div>
      <div class="input-group" id="lustGroup"><label>üö´ Lust Control</label>
       <div class="checkbox-group"><input type="checkbox" id="lust"> <label for="lust">Broke lust control (check if failed)</label>
       </div>
      </div>
     </div><button class="save-btn" onclick="saveData()">üíæ Save Today's Data</button>
     <div class="nav-buttons"><button class="nav-btn active" onclick="showChart('stretching')">üßò Stretching</button> <button class="nav-btn" onclick="showChart('steps')">üëü Steps</button> <button class="nav-btn" onclick="showChart('sleep')">üò¥ Sleep</button> <button class="nav-btn" onclick="showChart('water')">üíß Water</button> <button class="nav-btn" onclick="showChart('screenTime')">üì± Screen Time</button> <button class="nav-btn" onclick="showChart('pages')">üìö Reading</button> <button class="nav-btn" onclick="showChart('training')">üí™ Training</button>
     </div>
     <div class="chart-container">
      <div class="period-selector"><button class="period-btn active" onclick="changePeriod('daily')">Daily</button> <button class="period-btn" onclick="changePeriod('weekly')">Weekly</button> <button class="period-btn" onclick="changePeriod('monthly')">Monthly</button>
      </div>
      <div class="chart-title" id="chartTitle">
       Stretching Sessions - Last 7 Days
      </div>
      <div class="chart-wrapper">
       <canvas id="mainChart"></canvas>
      </div>
      <canvas id="mainChart" width="400" height="150"></canvas>
     </div>
    </div>
    <div class="sidebar">
     <div class="points-card">
       <div class="points-header">
         <div class="points-title">üéÆ Points System</div>
         <div class="points-total" id="totalPoints">0</div>
       </div>
       <div class="level-indicator">
         <div class="level-text" id="levelText">Level 1 (0/100)</div>
         <div class="level-bar">
           <div class="level-progress" id="levelProgress" style="width: 0%"></div>
         </div>
       </div>
       <div class="points-today" id="todayPoints">Today: 0 points</div>
       <div class="points-breakdown" id="pointsBreakdown">
         <!-- Points breakdown will be added here by JavaScript -->
       </div>
     </div>
     <div class="pause-section">
       <div class="pause-title">‚è∏Ô∏è Pause Streaks</div>
       <div class="pause-toggle" onclick="togglePause('steps')">
         <input type="checkbox" class="pause-checkbox" id="pauseSteps">
         <span class="pause-label">Steps Taken</span>
         <span class="pause-days" id="pauseStepsDays">0 days</span>
       </div>
       <div class="pause-toggle" onclick="togglePause('training')">
         <input type="checkbox" class="pause-checkbox" id="pauseTraining">
         <span class="pause-label">Training Sessions</span>
         <span class="pause-days" id="pauseTrainingDays">0 days</span>
       </div>
       <div class="pause-toggle" onclick="togglePause('coldShower')">
         <input type="checkbox" class="pause-checkbox" id="pauseColdShower">
         <span class="pause-label">Cold Showers</span>
         <span class="pause-days" id="pauseColdShowerDays">0 days</span>
       </div>
       <div class="pause-note">
         Toggle on to freeze streak when sick/resting
       </div>
       <div class="reset-section">
        <div class="reset-title">‚ö†Ô∏è Reset All Data</div>
        <button class="reset-btn" onclick="showResetConfirm()">üóëÔ∏è Hard Reset All Data</button>
        <div class="reset-confirm" id="resetConfirm">
          <div style="color: #856404; margin-bottom: 10px; font-weight: 600;">
            ‚ö†Ô∏è Are you sure? This will delete ALL data permanently!
          </div>
          <div class="reset-confirm-buttons">
            <button class="reset-confirm-btn reset-confirm-yes" onclick="hardReset()">Yes, Delete Everything</button>
            <button class="reset-confirm-btn reset-confirm-no" onclick="hideResetConfirm()">Cancel</button>
          </div>
        </div>
        <div class="reset-note">
          This will clear all input fields and delete all saved data
        </div>
      </div>
     </div>
     <div class="quote-card">
      <div class="quote-text" id="dailyQuote"></div>
      <div class="quote-author" id="quoteAuthor"></div>
     </div>
     <div class="sleep-card">
      <div class="consistency-title">
        üò¥ Sleep Analysis
      </div>
      <div id="sleepAnalysis">
        <div style="text-align: center; color: #888; padding: 20px;">
          Enter sleep data to see analysis
        </div>
      </div>
    </div>
     <div class="consistency-card">
      <div class="consistency-title">
       üéØ Today's Goals
      </div>
      <div id="consistencyTracker"></div>
     </div>
     <div class="consistency-card">
      <div class="consistency-title">
       üî• Consistency Streaks
      </div>
      <div id="streakTracker"></div>
     </div>
     <div class="consistency-card">
      <div class="consistency-title">
       üìä Total Statistics
      </div>
      <div id="totalStats"></div>
     </div>
    </div>
   </div>
  </div>
  <script>
        // Motivational quotes
        const quotes = [
            { text: "The only way to do great work is to love what you do.", author: "Steve Jobs" },
            { text: "Success is not final, failure is not fatal: it is the courage to continue that counts.", author: "Winston Churchill" },
            { text: "The future belongs to those who believe in the beauty of their dreams.", author: "Eleanor Roosevelt" },
            { text: "It is during our darkest moments that we must focus to see the light.", author: "Aristotle" },
            { text: "The only impossible journey is the one you never begin.", author: "Tony Robbins" },
            { text: "In the middle of difficulty lies opportunity.", author: "Albert Einstein" },
            { text: "Believe you can and you're halfway there.", author: "Theodore Roosevelt" },
            { text: "The way to get started is to quit talking and begin doing.", author: "Walt Disney" },
            { text: "Don't watch the clock; do what it does. Keep going.", author: "Sam Levenson" },
            { text: "A year from now you may wish you had started today.", author: "Karen Lamb" }
        ];
        
        // Goals for consistency tracking
        const goals = {
            steps: 10000,
            water: 2,
            pages: 20,
            stretching: 2,
            sleep: 8,
            screenTime: 2,
            training: 2
        };
        
        // Pause/Freeze functionality storage
        let pausedStreaks = JSON.parse(localStorage.getItem('pausedStreaks')) || {
            steps: { paused: false, days: 0 },
            training: { paused: false, days: 0 },
            coldShower: { paused: false, days: 0 }
        };
        
        let currentChart = null;
        let currentView = 'stretching';
        let currentPeriod = 'daily';
        
        // Initialize the app
        document.addEventListener('DOMContentLoaded', function() {
            displayCurrentDate();
            displayDailyQuote();
            loadTodaysData();
            updateConsistencyTracker();
            updateStreakTracker();
            updateTotalStats();
            initializeChart();
            // Initialize points display
            updatePointsDisplay();
            
            // Update points when inputs change
            ['stretching', 'steps', 'sleepHours', 'water', 'screenTime', 'pages', 
             'sleepQuality', 'remHours', 'remMinutes', 'deepHours', 'deepMinutes', 
             'lightHours', 'lightMinutes'].forEach(id => {
                const element = document.getElementById(id);
                if (element) {
                    element.addEventListener('input', updatePointsDisplay);
                }
            });
            
            // Update points when checkboxes change
            ['hadGym', 'hadRun', 'coldShower', 'lust', 'napped'].forEach(id => {
                const element = document.getElementById(id);
                if (element) {
                    element.addEventListener('change', updatePointsDisplay);
                }
            });
            
            // Initialize pause system
            updatePauseDisplay();
            resetPauseCounters();
            
            // Add event listeners for checkboxes
            document.getElementById('coldShower').addEventListener('change', updateCheckboxStyles);
            document.getElementById('lust').addEventListener('change', updateCheckboxStyles);
            
            // Add input event listeners for real-time consistency updates
            const inputs = ['stretching', 'steps', 'sleepHours', 'water', 'screenTime', 'pages'];
            inputs.forEach(input => {
                document.getElementById(input).addEventListener('input', updateConsistencyTracker);
            });
            
            // Add event listener for run checkbox to show/hide run details
            document.getElementById('hadRun').addEventListener('change', function() {
                const runDetails = document.getElementById('runDetails');
                if (this.checked) {
                    runDetails.style.display = 'grid';
                } else {
                    runDetails.style.display = 'none';
                    document.getElementById('runType').value = '';
                    document.getElementById('runDistance').value = '';
                }
                updateConsistencyTracker();
            });
            
            // Add event listeners for gym and run checkboxes
            document.getElementById('hadGym').addEventListener('change', updateConsistencyTracker);
            
            // Sleep input listeners - update to include all new inputs
            ['sleepHours', 'sleepMinutes', 'sleepQuality', 'remHours', 'remMinutes', 
             'deepHours', 'deepMinutes', 'lightHours', 'lightMinutes'].forEach(id => {
                document.getElementById(id).addEventListener('input', function() {
                    updateSleepAnalysis();
                    updateConsistencyTracker();
                });
            });
            
            document.getElementById('napped').addEventListener('change', function() {
                updateSleepAnalysis();
            });
            
            // Initialize sleep analysis
            updateSleepAnalysis();
        });

        // Points System Configuration
        const pointsConfig = {
            // Base points for reaching goals
            stretching: 10,
            steps: 15,
            sleep: 20,
            water: 10,
            screenTime: 15, // For staying under limit
            pages: 10,
            training: 25,
            coldShower: 20,
            lustControl: 30, // High value for self-control
            
            // Bonus points for exceeding goals
            stepsExceed: 0.001, // 1 point per 1000 extra steps
            sleepExceed: 5, // 5 points per extra hour
            waterExceed: 5, // 5 points per extra liter
            pagesExceed: 0.5, // 1 point per 2 extra pages
            stretchingExceed: 3, // 3 points per extra session
            
            // Streak multipliers
            streakMultipliers: {
                3: 1.2,  // 20% bonus for 3-day streak
                7: 1.5,  // 50% bonus for 7-day streak
                14: 2.0, // 100% bonus for 14-day streak
                30: 3.0  // 200% bonus for 30-day streak
            },
            
            // Daily bonus for completing all goals
            dailyCompletionBonus: 50
        };
        
        // Calculate points for today
        function calculateTodayPoints() {
            const currentData = getCurrentInputs();
            const allData = JSON.parse(localStorage.getItem('lifeTrackerData')) || {};
            const dates = Object.keys(allData).sort();
            const streaks = calculateStreaksWithPause(dates, allData);
            
            let totalPoints = 0;
            let pointsBreakdown = [];
            let completedGoals = 0;
            const totalGoals = Object.keys(goals).length + 2; // +2 for coldShower and lustControl
            
            // Calculate points for each goal
            Object.keys(goals).forEach(key => {
                let points = 0;
                let multiplier = 1;
                let description = '';
                let emoji = '';
                
                // Get streak multiplier
                const streak = streaks[key] || 0;
                for (const [days, mult] of Object.entries(pointsConfig.streakMultipliers).sort((a, b) => b[0] - a[0])) {
                    if (streak >= parseInt(days)) {
                        multiplier = mult;
                        break;
                    }
                }
                
                if (key === 'training') {
                    const hadGym = currentData.hadGym;
                    const hadRun = currentData.hadRun;
                    const trainingSessions = (hadGym ? 1 : 0) + (hadRun ? 1 : 0);
                    
                    if (trainingSessions >= goals.training) {
                        points = pointsConfig.training * multiplier;
                        description = `Training Sessions (${trainingSessions} sessions)`;
                        emoji = 'üí™';
                        completedGoals++;
                        
                        // Bonus for extra sessions
                        if (trainingSessions > goals.training) {
                            const extraSessions = trainingSessions - goals.training;
                            const bonus = extraSessions * 10; // 10 points per extra session
                            points += bonus;
                        }
                    }
                } else {
                    const current = parseFloat(currentData[key]) || 0;
                    const goal = goals[key];
                    const metGoal = key === 'screenTime' ? current <= goal : current >= goal;
                    
                    if (metGoal) {
                        points = pointsConfig[key] * multiplier;
                        description = key.charAt(0).toUpperCase() + key.slice(1);
                        if (key === 'screenTime') description = 'Screen Time';
                        emoji = getEmojiForActivity(key);
                        completedGoals++;
                        
                        // Bonus for exceeding goals (except screen time - lower is better)
                        if (key !== 'screenTime' && current > goal) {
                            const exceeded = current - goal;
                            let bonus = 0;
                            
                            if (key === 'steps' && pointsConfig.stepsExceed > 0) {
                                bonus = Math.floor(exceeded * pointsConfig.stepsExceed);
                            } else if (key === 'sleep' && pointsConfig.sleepExceed > 0) {
                                bonus = Math.floor(exceeded * pointsConfig.sleepExceed);
                            } else if (key === 'water' && pointsConfig.waterExceed > 0) {
                                bonus = Math.floor(exceeded * pointsConfig.waterExceed);
                            } else if (key === 'pages' && pointsConfig.pagesExceed > 0) {
                                bonus = Math.floor(exceeded * pointsConfig.pagesExceed);
                            } else if (key === 'stretching' && pointsConfig.stretchingExceed > 0) {
                                bonus = Math.floor(exceeded * pointsConfig.stretchingExceed);
                            }
                            
                            if (bonus > 0) {
                                points += bonus;
                                description += ` (+${bonus} bonus)`;
                            }
                        }
                    }
                }
                
                if (points > 0) {
                    totalPoints += points;
                    pointsBreakdown.push({
                        emoji: emoji,
                        description: description,
                        points: Math.round(points),
                        multiplier: multiplier > 1 ? `x${multiplier}` : ''
                    });
                }
            });
            
            // Cold shower points
            if (currentData.coldShower) {
                const streak = streaks.coldShower || 0;
                let multiplier = 1;
                for (const [days, mult] of Object.entries(pointsConfig.streakMultipliers).sort((a, b) => b[0] - a[0])) {
                    if (streak >= parseInt(days)) {
                        multiplier = mult;
                        break;
                    }
                }
                
                const points = pointsConfig.coldShower * multiplier;
                totalPoints += points;
                completedGoals++;
                pointsBreakdown.push({
                    emoji: 'üöø',
                    description: 'Cold Shower',
                    points: Math.round(points),
                    multiplier: multiplier > 1 ? `x${multiplier}` : ''
                });
            }
            
            // Lust control points (inverted - NOT checking the box is good)
            if (!currentData.lust) {
                const streak = streaks.lustControl || 0;
                let multiplier = 1;
                for (const [days, mult] of Object.entries(pointsConfig.streakMultipliers).sort((a, b) => b[0] - a[0])) {
                    if (streak >= parseInt(days)) {
                        multiplier = mult;
                        break;
                    }
                }
                
                const points = pointsConfig.lustControl * multiplier;
                totalPoints += points;
                completedGoals++;
                pointsBreakdown.push({
                    emoji: 'üö´',
                    description: 'Lust Control',
                    points: Math.round(points),
                    multiplier: multiplier > 1 ? `x${multiplier}` : ''
                });
            }
            
            // Daily completion bonus
            if (completedGoals === totalGoals) {
                totalPoints += pointsConfig.dailyCompletionBonus;
                pointsBreakdown.push({
                    emoji: 'üèÜ',
                    description: 'All Goals Completed!',
                    points: pointsConfig.dailyCompletionBonus,
                    multiplier: 'BONUS'
                });
            }
            
            return {
                total: Math.round(totalPoints),
                breakdown: pointsBreakdown,
                completedGoals: completedGoals,
                totalGoals: totalGoals
            };
        }
        
        function getEmojiForActivity(activity) {
            const emojis = {
                stretching: 'üßò',
                steps: 'üëü',
                sleep: 'üò¥',
                water: 'üíß',
                screenTime: 'üì±',
                pages: 'üìö',
                training: 'üí™'
            };
            return emojis[activity] || '‚≠ê';
        }
        
        // Update points display
        function updatePointsDisplay() {
            const pointsData = calculateTodayPoints();
            const totalPointsElement = document.getElementById('totalPoints');
            const todayPointsElement = document.getElementById('todayPoints');
            const breakdownElement = document.getElementById('pointsBreakdown');
            
            // Get lifetime points
            const lifetimePoints = calculateLifetimePoints();
            totalPointsElement.textContent = lifetimePoints.total;
            
            // Update today's points
            todayPointsElement.textContent = `Today: ${pointsData.total} points`;
            
            // Update breakdown
            let html = '';
            if (pointsData.breakdown.length > 0) {
                pointsData.breakdown.forEach(item => {
                    html += `
                        <div class="points-item">
                            <div class="points-activity">
                                <span class="points-emoji">${item.emoji}</span>
                                <span>${item.description}</span>
                            </div>
                            <div>
                                <span class="points-value">+${item.points}</span>
                                ${item.multiplier ? `<span class="points-multiplier">${item.multiplier}</span>` : ''}
                            </div>
                        </div>
                    `;
                });
            } else {
                html = `<div style="text-align: center; color: #888; padding: 10px;">Complete goals to earn points!</div>`;
            }
            
            breakdownElement.innerHTML = html;
            
            // Update level progress
            updateLevelProgress(lifetimePoints.total);
        }
        
        // Calculate lifetime points from all saved data
        function calculateLifetimePoints() {
            const allData = JSON.parse(localStorage.getItem('lifeTrackerData')) || {};
            const dates = Object.keys(allData).sort();
            
            let totalPoints = 0;
            let daysWithData = 0;
            
            // For each day with data, calculate what the points would have been
            dates.forEach(date => {
                // We can't perfectly recalculate without the exact inputs,
                // so we'll estimate or store points when saving
                daysWithData++;
            });
            
            // For now, return today's points as total
            // We'll need to modify saveData() to store points
            const todayPoints = calculateTodayPoints();
            
            // Try to get stored points from localStorage
            const storedPoints = JSON.parse(localStorage.getItem('lifeTrackerPoints')) || { total: 0 };
            
            return {
                total: storedPoints.total + todayPoints.total,
                days: daysWithData
            };
        }
        
        // Update level and progress bar
        function updateLevelProgress(totalPoints) {
            const levelProgress = document.getElementById('levelProgress');
            const levelText = document.getElementById('levelText');
            
            // Level formula: each level requires 100 * level points
            // Level 1: 0-100, Level 2: 100-300, Level 3: 300-600, etc.
            let level = 1;
            let pointsNeededForLevel = 100;
            let pointsForNextLevel = 100;
            let pointsInCurrentLevel = totalPoints;
            
            while (pointsInCurrentLevel >= pointsNeededForLevel) {
                pointsInCurrentLevel -= pointsNeededForLevel;
                level++;
                pointsNeededForLevel = level * 100;
                pointsForNextLevel = level * 100;
            }
            
            const progressPercent = (pointsInCurrentLevel / pointsForNextLevel) * 100;
            
            levelProgress.style.width = `${progressPercent}%`;
            levelText.textContent = `Level ${level} (${pointsInCurrentLevel}/${pointsForNextLevel})`;
        }
        
        // Modify saveData() to store points
        // Find your existing saveData() function and add this at the end:
        function saveData() {
            const today = new Date().toISOString().split('T')[0];
            const data = getCurrentInputs();
            
            // Get existing data
            let allData = JSON.parse(localStorage.getItem('lifeTrackerData')) || {};
            allData[today] = data;
            
            // Save to localStorage
            localStorage.setItem('lifeTrackerData', JSON.stringify(allData));
            
            // Calculate and save points
            const pointsData = calculateTodayPoints();
            let pointsHistory = JSON.parse(localStorage.getItem('lifeTrackerPoints')) || { total: 0, days: {} };
            
            // Only add points if we haven't already today
            if (!pointsHistory.days[today]) {
                pointsHistory.total += pointsData.total;
                pointsHistory.days[today] = {
                    points: pointsData.total,
                    breakdown: pointsData.breakdown
                };
                localStorage.setItem('lifeTrackerPoints', JSON.stringify(pointsHistory));
            }
            
            // Show success message
            const btn = document.querySelector('.save-btn');
            const originalText = btn.textContent;
            btn.textContent = '‚úÖ Saved Successfully!';
            btn.style.background = 'linear-gradient(135deg, #4CAF50, #45a049)';
            
            setTimeout(() => {
                btn.textContent = originalText;
                btn.style.background = 'linear-gradient(135deg, #4CAF50, #45a049)';
            }, 2000);
            
            // Update chart and streaks
            updateChart();
            updateStreakTracker();
            updateTotalStats();
            updatePointsDisplay(); // Add this line
        }
   
        function displayCurrentDate() {
            const today = new Date();
            const options = { 
                weekday: 'long', 
                year: 'numeric', 
                month: 'long', 
                day: 'numeric' 
            };
            document.getElementById('currentDate').textContent = today.toLocaleDateString('en-US', options);
            
            // Clear old data for new day
            clearOldData();
        }
        
        function clearOldData() {
            const today = new Date().toISOString().split('T')[0];
            const allData = JSON.parse(localStorage.getItem('lifeTrackerData')) || {};
            
            // Check if we already have data for today
            if (allData[today]) {
                // We have data for today, so don't clear
                return;
            }
            
            // Clear all input fields
            const inputsToClear = [
                'stretching', 'steps', 'sleepHours', 'sleepMinutes', 
                'water', 'screenTime', 'pages', 'sleepQuality',
                'remHours', 'remMinutes', 'deepHours', 'deepMinutes', 
                'lightHours', 'lightMinutes', 'runDistance'
            ];
            
            inputsToClear.forEach(id => {
                const element = document.getElementById(id);
                if (element) element.value = '';
            });
            
            // Clear checkboxes
            const checkboxesToClear = ['hadGym', 'hadRun', 'coldShower', 'lust', 'napped'];
            checkboxesToClear.forEach(id => {
                const element = document.getElementById(id);
                if (element) element.checked = false;
            });
            
            // Clear select dropdowns
            document.getElementById('runType').value = '';
            
            // Hide run details
            document.getElementById('runDetails').style.display = 'none';
            
            // Update UI
            updateCheckboxStyles();
            updateConsistencyTracker();
            updateSleepAnalysis();
        }

        // Hard Reset functionality
        function showResetConfirm() {
            document.getElementById('resetConfirm').style.display = 'block';
        }
        
        function hideResetConfirm() {
            document.getElementById('resetConfirm').style.display = 'none';
        }
        
        function hardReset() {
            // Clear all localStorage data
            localStorage.removeItem('lifeTrackerData');
            localStorage.removeItem('pausedStreaks');
            localStorage.removeItem('lastPauseReset');
            
            // Clear all input fields
            const inputsToClear = [
                'stretching', 'steps', 'sleepHours', 'sleepMinutes', 
                'water', 'screenTime', 'pages', 'sleepQuality',
                'remHours', 'remMinutes', 'deepHours', 'deepMinutes', 
                'lightHours', 'lightMinutes', 'runDistance'
            ];
            
            inputsToClear.forEach(id => {
                const element = document.getElementById(id);
                if (element) element.value = '';
            });
            
            // Clear checkboxes
            const checkboxesToClear = ['hadGym', 'hadRun', 'coldShower', 'lust', 'napped'];
            checkboxesToClear.forEach(id => {
                const element = document.getElementById(id);
                if (element) element.checked = false;
            });
            
            // Clear select dropdowns
            document.getElementById('runType').value = '';
            
            // Hide run details
            document.getElementById('runDetails').style.display = 'none';
            
            // Reset pause streaks
            pausedStreaks = {
                steps: { paused: false, days: 0 },
                training: { paused: false, days: 0 },
                coldShower: { paused: false, days: 0 }
            };
            
            // Reset today's date for pause reset
            const today = new Date().toISOString().split('T')[0];
            localStorage.setItem('lastPauseReset', today);
            localStorage.setItem('pausedStreaks', JSON.stringify(pausedStreaks));
            
            // Hide confirmation
            hideResetConfirm();
            
            // Update all UI components
            updateCheckboxStyles();
            updateConsistencyTracker();
            updateSleepAnalysis();
            updateStreakTracker();
            updateTotalStats();
            updatePauseDisplay();
            updateChart();
            
            // Show success message
            const resetBtn = document.querySelector('.reset-btn');
            const originalText = resetBtn.textContent;
            resetBtn.textContent = '‚úÖ All Data Cleared!';
            resetBtn.style.background = 'linear-gradient(135deg, #4CAF50, #45a049)';
            
            setTimeout(() => {
                resetBtn.textContent = originalText;
                resetBtn.style.background = 'linear-gradient(135deg, #f44336, #d32f2f)';
            }, 3000);
        }
        
        // Optional: Add a keyboard shortcut for reset (Shift+R)
        document.addEventListener('keydown', function(event) {
            if (event.shiftKey && event.key === 'R') {
                showResetConfirm();
            }
        });
   
        function displayDailyQuote() {
            const today = new Date();
            const dayOfYear = Math.floor((today - new Date(today.getFullYear(), 0, 0)) / 1000 / 60 / 60 / 24);
            const quoteIndex = dayOfYear % quotes.length;
            const todaysQuote = quotes[quoteIndex];
            
            document.getElementById('dailyQuote').textContent = `"${todaysQuote.text}"`;
            document.getElementById('quoteAuthor').textContent = `‚Äî ${todaysQuote.author}`;
        }
        
        function updateCheckboxStyles() {
            const coldShowerGroup = document.getElementById('coldShowerGroup');
            const lustGroup = document.getElementById('lustGroup');
            const coldShowerChecked = document.getElementById('coldShower').checked;
            const lustChecked = document.getElementById('lust').checked;
            
            if (coldShowerChecked) {
                coldShowerGroup.classList.add('cold-shower-checked');
            } else {
                coldShowerGroup.classList.remove('cold-shower-checked');
            }
            
            if (lustChecked) {
                lustGroup.classList.add('lust-checked');
            } else {
                lustGroup.classList.remove('lust-checked');
            }
            
            updateConsistencyTracker();
        }
        
        // Pause/Freeze functionality
        function togglePause(streakType) {
            const checkbox = document.getElementById(`pause${streakType.charAt(0).toUpperCase() + streakType.slice(1)}`);
            const toggleElement = checkbox.parentElement;
            
            // Toggle the paused state
            pausedStreaks[streakType].paused = !pausedStreaks[streakType].paused;
            
            // Update UI
            checkbox.checked = pausedStreaks[streakType].paused;
            toggleElement.classList.toggle('active', pausedStreaks[streakType].paused);
            
            // If pausing, increment days counter
            if (pausedStreaks[streakType].paused) {
                pausedStreaks[streakType].days++;
                updatePauseDisplay();
            }
            
            // Save to localStorage
            localStorage.setItem('pausedStreaks', JSON.stringify(pausedStreaks));
            
            // Update streaks display
            updateStreakTracker();
        }
        
        function updatePauseDisplay() {
            // Update the days counters
            Object.keys(pausedStreaks).forEach(streakType => {
                const daysElement = document.getElementById(`pause${streakType.charAt(0).toUpperCase() + streakType.slice(1)}Days`);
                if (daysElement) {
                    daysElement.textContent = `${pausedStreaks[streakType].days} day${pausedStreaks[streakType].days !== 1 ? 's' : ''}`;
                }
                
                // Update checkbox and toggle state
                const checkbox = document.getElementById(`pause${streakType.charAt(0).toUpperCase() + streakType.slice(1)}`);
                if (checkbox) {
                    const toggleElement = checkbox.parentElement;
                    checkbox.checked = pausedStreaks[streakType].paused;
                    if (toggleElement) {
                        toggleElement.classList.toggle('active', pausedStreaks[streakType].paused);
                    }
                }
            });
        }
        
        function resetPauseCounters() {
            const today = new Date().toISOString().split('T')[0];
            const lastReset = localStorage.getItem('lastPauseReset') || '';
            
            // Reset pause days if it's a new day
            if (today !== lastReset) {
                Object.keys(pausedStreaks).forEach(streakType => {
                    // If streak was paused yesterday, keep counting
                    if (pausedStreaks[streakType].paused) {
                        // Don't reset the counter, let it keep counting
                        // This allows multiple consecutive paused days
                    } else {
                        // If not paused, reset counter to 0
                        pausedStreaks[streakType].days = 0;
                    }
                });
                
                localStorage.setItem('lastPauseReset', today);
                localStorage.setItem('pausedStreaks', JSON.stringify(pausedStreaks));
                updatePauseDisplay();
            }
        }
        
        function updateStreakTracker() {
            const allData = JSON.parse(localStorage.getItem('lifeTrackerData')) || {};
            const dates = Object.keys(allData).sort();
            const streakTracker = document.getElementById('streakTracker');
            
            const streaks = calculateStreaksWithPause(dates, allData);
            
            let html = '';
            Object.keys(streaks).forEach(key => {
                const streak = streaks[key];
                let displayName = key.charAt(0).toUpperCase() + key.slice(1);
                if (key === 'screenTime') displayName = 'Screen Time';
                if (key === 'coldShower') displayName = 'Cold Shower';
                if (key === 'lustControl') displayName = 'Lust Control';
                
                // Determine color based on streak length
                let streakColor = '#666';
                let flameIcon = '';
                let pausedIndicator = '';
                
                // Check if this streak is paused
                if ((key === 'steps' && pausedStreaks.steps.paused) ||
                    (key === 'training' && pausedStreaks.training.paused) ||
                    (key === 'coldShower' && pausedStreaks.coldShower.paused)) {
                    pausedIndicator = ' ‚è∏Ô∏è';
                    streakColor = '#6c757d'; // Gray color for paused streaks
                } else if (streak >= 7) {
                    streakColor = '#4CAF50';
                    flameIcon = 'üî•';
                } else if (streak >= 3) {
                    streakColor = '#FF9800';
                    flameIcon = 'üî•';
                } else if (streak > 0) {
                    streakColor = '#667eea';
                    flameIcon = '‚ú®';
                }
                
                html += `
                    <div class="consistency-item">
                        <span>${displayName}</span>
                        <div style="color: ${streakColor}; font-weight: bold; font-size: 1.1rem;">
                            ${streak} day${streak !== 1 ? 's' : ''} ${flameIcon}${pausedIndicator}
                        </div>
                    </div>
                `;
            });
            
            streakTracker.innerHTML = html;
        }
        
        function calculateStreaksWithPause(dates, allData) {
            const streaks = calculateStreaks(dates, allData);
            
            // Apply pause to specific streaks
            if (pausedStreaks.steps.paused) {
                streaks.steps = Math.max(streaks.steps, pausedStreaks.steps.days + 1);
            }
            
            if (pausedStreaks.training.paused) {
                streaks.training = Math.max(streaks.training, pausedStreaks.training.days + 1);
            }
            
            if (pausedStreaks.coldShower.paused) {
                streaks.coldShower = Math.max(streaks.coldShower, pausedStreaks.coldShower.days + 1);
            }
            
            return streaks;
        }
        
        function calculateStreaks(dates, allData) {
            const streaks = {
                stretching: 0,
                steps: 0,
                sleep: 0,
                water: 0,
                screenTime: 0,
                pages: 0,
                training: 0,
                coldShower: 0,
                lustControl: 0
            };
            
            if (dates.length === 0) return streaks;
            
            // Get today's date
            const today = new Date();
            const todayStr = today.toISOString().split('T')[0];
            
            // Helper function to check if a goal was met on a specific day
            function goalMet(date, goalKey) {
                const dayData = allData[date];
                if (!dayData) return false;
                
                if (goalKey === 'coldShower') {
                    return dayData.coldShower === true;
                }
                
                if (goalKey === 'lustControl') {
                    return dayData.lust !== true;
                }
                
                if (goalKey === 'training') {
                    const hadGym = dayData.hadGym === true ? 1 : 0;
                    const hadRun = dayData.hadRun === true ? 1 : 0;
                    return (hadGym + hadRun) >= goals.training;
                }
                
                const value = parseFloat(dayData[goalKey]) || 0;
                const goal = goals[goalKey];
                
                if (goalKey === 'screenTime') {
                    return value <= goal;
                }
                
                return value >= goal;
            }
            
            // Calculate streak for each goal
            Object.keys(streaks).forEach(goalKey => {
                let streak = 0;
                let checkingDate = new Date(today);
                
                // Start checking from today backwards
                for (let i = 0; i < 365; i++) { // Check up to a year back
                    const dateStr = checkingDate.toISOString().split('T')[0];
                    const dayData = allData[dateStr];
                    
                    if (dayData) {
                        // If we have data for this day and goal was met
                        if (goalMet(dateStr, goalKey)) {
                            streak++;
                        } else {
                            // Goal wasn't met, streak ends
                            break;
                        }
                    } else {
                        // No data for this day, streak ends
                        break;
                    }
                    
                    // Move to previous day
                    checkingDate.setDate(checkingDate.getDate() - 1);
                }
                
                streaks[goalKey] = streak;
            });
            
            return streaks;
        }
        
        function updateTotalStats() {
            const allData = JSON.parse(localStorage.getItem('lifeTrackerData')) || {};
            const totalStatsElement = document.getElementById('totalStats');
            
            // Calculate totals
            const totals = {
                stretching: 0,
                steps: 0,
                sleep: 0,
                water: 0,
                screenTime: 0,
                pages: 0,
                gymSessions: 0,
                runs: 0,
                totalRunDistance: 0,
                coldShowers: 0,
                naps: 0
            };
            
            let totalDays = 0;
            
            Object.keys(allData).forEach(date => {
                const dayData = allData[date];
                totalDays++;
                
                totals.stretching += parseFloat(dayData.stretching) || 0;
                totals.steps += parseFloat(dayData.steps) || 0;
                totals.sleep += parseFloat(dayData.sleep) || 0;
                totals.water += parseFloat(dayData.water) || 0;
                totals.screenTime += parseFloat(dayData.screenTime) || 0;
                totals.pages += parseFloat(dayData.pages) || 0;
                
                if (dayData.hadGym === true) totals.gymSessions++;
                if (dayData.hadRun === true) {
                    totals.runs++;
                    totals.totalRunDistance += parseFloat(dayData.runDistance) || 0;
                }
                
                if (dayData.coldShower === true) totals.coldShowers++;
                if (dayData.napped === true) totals.naps++;
            });
            
            let html = '';
            
            // Format numbers nicely
            const formatNumber = (num) => {
                if (num >= 1000000) return (num / 1000000).toFixed(1) + 'M';
                if (num >= 1000) return (num / 1000).toFixed(1) + 'K';
                return Math.round(num * 10) / 10;
            };
            
            html += `
                <div class="consistency-item">
                    <span>üßò Total Stretching</span>
                    <div style="font-weight: bold; color: #667eea;">${formatNumber(totals.stretching)}</div>
                </div>
                <div class="consistency-item">
                    <span>üëü Total Steps</span>
                    <div style="font-weight: bold; color: #667eea;">${formatNumber(totals.steps)}</div>
                </div>
                <div class="consistency-item">
                    <span>üò¥ Total Sleep</span>
                    <div style="font-weight: bold; color: #667eea;">${formatNumber(totals.sleep)}h</div>
                </div>
                <div class="consistency-item">
                    <span>üíß Total Water</span>
                    <div style="font-weight: bold; color: #667eea;">${formatNumber(totals.water)}L</div>
                </div>
                <div class="consistency-item">
                    <span>üì± Total Screen Time</span>
                    <div style="font-weight: bold; color: #667eea;">${formatNumber(totals.screenTime)}h</div>
                </div>
                <div class="consistency-item">
                    <span>üìö Total Pages</span>
                    <div style="font-weight: bold; color: #667eea;">${formatNumber(totals.pages)}</div>
                </div>
                <div class="consistency-item">
                    <span>üèãÔ∏è Gym Sessions</span>
                    <div style="font-weight: bold; color: #667eea;">${totals.gymSessions}</div>
                </div>
                <div class="consistency-item">
                    <span>üèÉ Total Runs</span>
                    <div style="font-weight: bold; color: #667eea;">${totals.runs}</div>
                </div>
                <div class="consistency-item">
                    <span>üìè Total Distance</span>
                    <div style="font-weight: bold; color: #667eea;">${formatNumber(totals.totalRunDistance)}km</div>
                </div>
                <div class="consistency-item">
                    <span>üöø Cold Showers</span>
                    <div style="font-weight: bold; color: #4CAF50;">${totals.coldShowers}</div>
                </div>
                <div class="consistency-item">
                    <span>üò¥ Naps Taken</span>
                    <div style="font-weight: bold; color: #667eea;">${totals.naps}</div>
                </div>
                <div class="consistency-item">
                    <span>üìÖ Days Tracked</span>
                    <div style="font-weight: bold; color: #764ba2;">${totalDays}</div>
                </div>
            `;
            
            totalStatsElement.innerHTML = html;
        }
        
        function updateConsistencyTracker() {
            const tracker = document.getElementById('consistencyTracker');
            const currentData = getCurrentInputs();
            
            let html = '';
            
            // Regular metrics
            Object.keys(goals).forEach(key => {
                if (key === 'training') {
                    // Special handling for training
                    const hadGym = currentData.hadGym;
                    const hadRun = currentData.hadRun;
                    const trainingSessions = (hadGym ? 1 : 0) + (hadRun ? 1 : 0);
                    const isGood = trainingSessions >= goals.training;
                    const status = isGood ? 'good' : 'bad';
                    const icon = isGood ? '‚úì' : '‚úó';
                    
                    html += `
                        <div class="consistency-item">
                            <span>Training</span>
                            <div class="consistency-status status-${status}">${icon}</div>
                        </div>
                    `;
                } else {
                    const current = parseFloat(currentData[key]) || 0;
                    const goal = goals[key];
                    const isGood = key === 'screenTime' ? current <= goal : current >= goal;
                    const status = isGood ? 'good' : 'bad';
                    const icon = isGood ? '‚úì' : '‚úó';
                    
                    let displayName = key.charAt(0).toUpperCase() + key.slice(1);
                    if (key === 'screenTime') displayName = 'Screen Time';
                    
                    html += `
                        <div class="consistency-item">
                            <span>${displayName}</span>
                            <div class="consistency-status status-${status}">${icon}</div>
                        </div>
                    `;
                }
            });
            
            // Cold shower
            const coldShower = document.getElementById('coldShower').checked;
            html += `
                <div class="consistency-item">
                    <span>Cold Shower</span>
                    <div class="consistency-status status-${coldShower ? 'good' : 'bad'}">${coldShower ? '‚úì' : '‚úó'}</div>
                </div>
            `;
            
            // Lust control (inverted - checked is bad)
            const lust = document.getElementById('lust').checked;
            html += `
                <div class="consistency-item">
                    <span>Lust Control</span>
                    <div class="consistency-status status-${lust ? 'bad' : 'good'}">${lust ? '‚úó' : '‚úì'}</div>
                </div>
            `;
            
            tracker.innerHTML = html;
        }
        
        function getCurrentInputs() {
            // Calculate total sleep in hours (including decimals)
            const sleepHours = parseFloat(document.getElementById('sleepHours').value) || 0;
            const sleepMinutes = parseFloat(document.getElementById('sleepMinutes').value) || 0;
            const totalSleepHours = sleepHours + (sleepMinutes / 60);
            
            // Calculate REM sleep in minutes
            const remHours = parseFloat(document.getElementById('remHours').value) || 0;
            const remMinutes = parseFloat(document.getElementById('remMinutes').value) || 0;
            const totalRemMinutes = (remHours * 60) + remMinutes;
            
            // Calculate Deep sleep in minutes
            const deepHours = parseFloat(document.getElementById('deepHours').value) || 0;
            const deepMinutes = parseFloat(document.getElementById('deepMinutes').value) || 0;
            const totalDeepMinutes = (deepHours * 60) + deepMinutes;
            
            // Calculate Light sleep in minutes
            const lightHours = parseFloat(document.getElementById('lightHours').value) || 0;
            const lightMinutes = parseFloat(document.getElementById('lightMinutes').value) || 0;
            const totalLightMinutes = (lightHours * 60) + lightMinutes;
            
            return {
                stretching: document.getElementById('stretching').value,
                steps: document.getElementById('steps').value,
                sleep: totalSleepHours.toFixed(2), // Keep as decimal hours for chart
                sleepHours: sleepHours,
                sleepMinutes: sleepMinutes,
                sleepQuality: document.getElementById('sleepQuality').value,
                remSleep: totalRemMinutes, // Store as total minutes
                remHours: remHours,
                remMinutes: remMinutes,
                deepSleep: totalDeepMinutes, // Store as total minutes
                deepHours: deepHours,
                deepMinutes: deepMinutes,
                lightSleep: totalLightMinutes, // Store as total minutes
                lightHours: lightHours,
                lightMinutes: lightMinutes,
                napped: document.getElementById('napped').checked,
                water: document.getElementById('water').value,
                screenTime: document.getElementById('screenTime').value,
                pages: document.getElementById('pages').value,
                hadGym: document.getElementById('hadGym').checked,
                hadRun: document.getElementById('hadRun').checked,
                runType: document.getElementById('runType').value,
                runDistance: document.getElementById('runDistance').value,
                coldShower: document.getElementById('coldShower').checked,
                lust: document.getElementById('lust').checked
            };
        }
        
        function updateSleepAnalysis() {
            const sleepQuality = parseInt(document.getElementById('sleepQuality').value) || 0;
            const sleepHours = parseFloat(document.getElementById('sleepHours').value) || 0;
            const sleepMinutes = parseFloat(document.getElementById('sleepMinutes').value) || 0;
            const totalSleepHours = sleepHours + (sleepMinutes / 60);
            
            // Calculate REM sleep in minutes
            const remHours = parseFloat(document.getElementById('remHours').value) || 0;
            const remMinutes = parseFloat(document.getElementById('remMinutes').value) || 0;
            const totalRemMinutes = (remHours * 60) + remMinutes;
            
            // Calculate Deep sleep in minutes
            const deepHours = parseFloat(document.getElementById('deepHours').value) || 0;
            const deepMinutes = parseFloat(document.getElementById('deepMinutes').value) || 0;
            const totalDeepMinutes = (deepHours * 60) + deepMinutes;
            
            // Calculate Light sleep in minutes
            const lightHours = parseFloat(document.getElementById('lightHours').value) || 0;
            const lightMinutes = parseFloat(document.getElementById('lightMinutes').value) || 0;
            const totalLightMinutes = (lightHours * 60) + lightMinutes;
            
            const napped = document.getElementById('napped').checked;
            
            const sleepAnalysis = document.getElementById('sleepAnalysis');
            
            let html = '';
            
            // Sleep Score with emoji based on quality
            let sleepEmoji = 'üò¥';
            let sleepColor = '#667eea';
            if (sleepQuality >= 80) {
                sleepEmoji = 'üòä';
                sleepColor = '#4CAF50';
            } else if (sleepQuality >= 60) {
                sleepEmoji = 'üòê';
                sleepColor = '#FF9800';
            } else if (sleepQuality > 0) {
                sleepEmoji = 'üòü';
                sleepColor = '#f44336';
            }
            
            // Format sleep time display
            let sleepTimeDisplay = '';
            if (sleepHours > 0 || sleepMinutes > 0) {
                if (sleepHours > 0 && sleepMinutes > 0) {
                    sleepTimeDisplay = `${sleepHours}h ${sleepMinutes}m`;
                } else if (sleepHours > 0) {
                    sleepTimeDisplay = `${sleepHours}h`;
                } else {
                    sleepTimeDisplay = `${sleepMinutes}m`;
                }
            }
            
            html += `
                <div class="sleep-score" style="color: ${sleepColor}">
                    ${sleepQuality > 0 ? sleepQuality : '--'}/100 ${sleepEmoji}
                </div>
                <div style="text-align: center; color: #666; margin-bottom: 15px;">
                    ${sleepTimeDisplay || 'No sleep data'}
                    ${napped ? ' + Nap üí§' : ''}
                </div>
            `;
            
            // Sleep stage breakdown (only show if we have data)
            const totalMinutes = totalRemMinutes + totalDeepMinutes + totalLightMinutes;
            if (totalMinutes > 0) {
                const remPercent = Math.round((totalRemMinutes/totalMinutes)*100);
                const deepPercent = Math.round((totalDeepMinutes/totalMinutes)*100);
                const lightPercent = Math.round((totalLightMinutes/totalMinutes)*100);
                
                // Format function for display
                const formatTime = (totalMinutes) => {
                    const hours = Math.floor(totalMinutes / 60);
                    const minutes = totalMinutes % 60;
                    if (hours > 0 && minutes > 0) {
                        return `${hours}h ${minutes}m`;
                    } else if (hours > 0) {
                        return `${hours}h`;
                    } else {
                        return `${minutes}m`;
                    }
                };
                
                html += `
                    <div class="sleep-breakdown">
                        <div class="sleep-metric" style="border-left: 4px solid #667eea;">
                            <div class="sleep-metric-label">REM Sleep</div>
                            <div class="sleep-metric-value">${formatTime(totalRemMinutes)}</div>
                            <div style="font-size: 0.7rem; color: #888;">
                                ${remPercent}%
                            </div>
                            <div class="sleep-stage-bar">
                                <div class="sleep-stage-fill" style="width: ${remPercent}%; background: #667eea;"></div>
                            </div>
                        </div>
                        <div class="sleep-metric" style="border-left: 4px solid #4CAF50;">
                            <div class="sleep-metric-label">Deep Sleep</div>
                            <div class="sleep-metric-value">${formatTime(totalDeepMinutes)}</div>
                            <div style="font-size: 0.7rem; color: #888;">
                                ${deepPercent}%
                            </div>
                            <div class="sleep-stage-bar">
                                <div class="sleep-stage-fill" style="width: ${deepPercent}%; background: #4CAF50;"></div>
                            </div>
                        </div>
                        <div class="sleep-metric" style="border-left: 4px solid #FF9800;">
                            <div class="sleep-metric-label">Light Sleep</div>
                            <div class="sleep-metric-value">${formatTime(totalLightMinutes)}</div>
                            <div style="font-size: 0.7rem; color: #888;">
                                ${lightPercent}%
                            </div>
                            <div class="sleep-stage-bar">
                                <div class="sleep-stage-fill" style="width: ${lightPercent}%; background: #FF9800;"></div>
                            </div>
                        </div>
                        <div class="sleep-metric" style="border-left: 4px solid #9C27B0;">
                            <div class="sleep-metric-label">Total Stages</div>
                            <div class="sleep-metric-value">${formatTime(totalMinutes)}</div>
                            <div style="font-size: 0.7rem; color: #888;">
                                ${Math.floor(totalMinutes/60)}h ${totalMinutes%60}m
                            </div>
                            <div class="sleep-stage-bar">
                                <div class="sleep-stage-fill" style="width: 100%; background: #9C27B0;"></div>
                            </div>
                        </div>
                    </div>
                    
                    <div style="margin-top: 15px; padding-top: 15px; border-top: 1px solid #eee; text-align: center; font-size: 0.9rem; color: #666;">
                        <div>üí° Ideal: 1.5-2h REM, 1-1.5h Deep sleep</div>
                        <div style="font-size: 0.8rem; color: #888; margin-top: 3px;">(20-25% each of total sleep)</div>
                    </div>
                `;
            } else if (totalSleepHours > 0) {
                html += `
                    <div style="text-align: center; color: #888; padding: 20px;">
                        Enter sleep stage details for breakdown
                    </div>
                `;
            } else {
                html += `
                    <div style="text-align: center; color: #888; padding: 20px;">
                        Enter sleep data to see analysis
                    </div>
                `;
            }
            
            sleepAnalysis.innerHTML = html;
        }
        
        function saveData() {
            const today = new Date().toISOString().split('T')[0];
            const data = getCurrentInputs();
            
            // Get existing data
            let allData = JSON.parse(localStorage.getItem('lifeTrackerData')) || {};
            allData[today] = data;
            
            // Save to localStorage
            localStorage.setItem('lifeTrackerData', JSON.stringify(allData));
            
            // Show success message
            const btn = document.querySelector('.save-btn');
            const originalText = btn.textContent;
            btn.textContent = '‚úÖ Saved Successfully!';
            btn.style.background = 'linear-gradient(135deg, #4CAF50, #45a049)';
            
            setTimeout(() => {
                btn.textContent = originalText;
                btn.style.background = 'linear-gradient(135deg, #4CAF50, #45a049)';
            }, 2000);
            
            // Update chart and streaks
            updateChart();
            updateStreakTracker();
            updateTotalStats();
        }
        
        function loadTodaysData() {
            const today = new Date().toISOString().split('T')[0];
            const allData = JSON.parse(localStorage.getItem('lifeTrackerData')) || {};
            const todaysData = allData[today];
            
            if (todaysData) {
                // List of all possible fields
                const fields = [
                    'stretching', 'steps', 'sleep', 'sleepHours', 'sleepMinutes',
                    'sleepQuality', 'remSleep', 'remHours', 'remMinutes',
                    'deepSleep', 'deepHours', 'deepMinutes', 'lightSleep', 
                    'lightHours', 'lightMinutes', 'water', 'screenTime', 'pages',
                    'runType', 'runDistance'
                ];
                
                const checkboxes = ['napped', 'hadGym', 'hadRun', 'coldShower', 'lust'];
                
                // Set values for regular fields
                fields.forEach(key => {
                    const element = document.getElementById(key);
                    if (element && todaysData[key] !== undefined) {
                        element.value = todaysData[key];
                    }
                });
                
                // Set values for checkboxes
                checkboxes.forEach(key => {
                    const element = document.getElementById(key);
                    if (element && todaysData[key] !== undefined) {
                        element.checked = todaysData[key];
                    }
                });
                
                // Show run details if hadRun is checked
                if (todaysData.hadRun) {
                    document.getElementById('runDetails').style.display = 'grid';
                }
                
                updateCheckboxStyles();
                updateConsistencyTracker();
                updateSleepAnalysis();
            }
        }
        
        function showChart(type) {
            currentView = type;
            
            // Update active button
            document.querySelectorAll('.nav-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            
            updateChart();
        }
        
        function changePeriod(period) {
            currentPeriod = period;
            
            // Update active button
            document.querySelectorAll('.period-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            
            updateChart();
        }
        
        function initializeChart() {
            const ctx = document.getElementById('mainChart').getContext('2d');
            currentChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: [],
                    datasets: []
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true
                        }
                    },
                    plugins: {
                        legend: {
                            display: true,
                            position: 'top'
                        }
                    }
                }
            });
            
            updateChart();
        }
        
        function updateChart() {
            const allData = JSON.parse(localStorage.getItem('lifeTrackerData')) || {};
            const dates = Object.keys(allData).sort();
            
            let chartData = getChartData(dates, allData);
            
            if (currentChart) {
                currentChart.data = chartData;
                currentChart.update();
            }
            
            // Update chart title
            const titles = {
                stretching: 'Stretching Sessions',
                steps: 'Steps Taken',
                sleep: 'Sleep Hours',
                water: 'Water Intake (Liters)',
                screenTime: 'Screen Time (Hours)',
                pages: 'Pages Read',
                training: 'Training Sessions'
            };
            
            const periodText = currentPeriod === 'daily' ? 'Last 7 Days' : 
                              currentPeriod === 'weekly' ? 'Last 4 Weeks' : 'Last 6 Months';
            
            document.getElementById('chartTitle').textContent = `${titles[currentView] || currentView} - ${periodText}`;
        }
        
        function getChartData(dates, allData) {
            const now = new Date();
            let filteredDates = [];
            
            if (currentPeriod === 'daily') {
                // Last 7 days
                for (let i = 6; i >= 0; i--) {
                    const date = new Date(now);
                    date.setDate(date.getDate() - i);
                    filteredDates.push(date.toISOString().split('T')[0]);
                }
            } else if (currentPeriod === 'weekly') {
                // Last 4 weeks (weekly averages)
                for (let i = 3; i >= 0; i--) {
                    const date = new Date(now);
                    date.setDate(date.getDate() - (i * 7));
                    filteredDates.push(`Week of ${date.toLocaleDateString()}`);
                }
            } else {
                // Last 6 months (monthly averages)
                for (let i = 5; i >= 0; i--) {
                    const date = new Date(now);
                    date.setMonth(date.getMonth() - i);
                    filteredDates.push(date.toLocaleDateString('en-US', { month: 'long', year: 'numeric' }));
                }
            }
            
            return getSingleMetricChartData(filteredDates, allData, currentView);
        }
        
        function getSingleMetricChartData(labels, allData, metric) {
            const data = labels.map(label => {
                if (currentPeriod === 'daily') {
                    const dayData = allData[label];
                    if (metric === 'training') {
                        // Special handling for training
                        if (dayData) {
                            const hadGym = dayData.hadGym === true ? 1 : 0;
                            const hadRun = dayData.hadRun === true ? 1 : 0;
                            return hadGym + hadRun;
                        }
                        return 0;
                    }
                    return dayData ? (parseFloat(dayData[metric]) || 0) : 0;
                }
                return 0; // Simplified for demo
            });
            
            // Chart colors based on metric
            const colors = {
                stretching: '#667eea',
                steps: '#4CAF50',
                sleep: '#2196F3',
                water: '#00BCD4',
                screenTime: '#FF9800',
                pages: '#9C27B0',
                training: '#f44336'
            };
            
            return {
                labels,
                datasets: [{
                    label: metric.charAt(0).toUpperCase() + metric.slice(1),
                    data,
                    borderColor: colors[metric] || '#667eea',
                    backgroundColor: (colors[metric] || '#667eea') + '20',
                    tension: 0.4,
                    fill: true
                }]
            };
        }
    </script>
 <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9af8e80117f65a7e',t:'MTc2NjAwMDU3My4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>

</html>

















